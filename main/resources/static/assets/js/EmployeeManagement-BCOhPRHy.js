import{x as e,X as a,r as l,k as t,z as n,A as s,I as u,ak as o,aD as i,O as d,a4 as r,M as c,V as p,K as v,y as m,C as b}from"./vue-vendor-DbIISveR.js";import{f as h,d as y,c as f,e as k}from"./employee-Dqt5o1ra.js";import{_ as g}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"../index-CK1BbKi4.js";import"./element-plus-C89kzd44.js";const j={class:"employee-management"},D={class:"page-header"},C={class:"search-area"},V={class:"search-inputs"},w=["value"],U={class:"table-container"},_=["onClick"],q=["onClick"],x={key:0,class:"dialog-overlay"},I={class:"dialog"},O={class:"form-group"},z=["disabled"],M={class:"form-group"},S={class:"form-group"},A=["value"],E={class:"form-group"},K={class:"form-group"},L=g(e({__name:"EmployeeManagement",setup(e){const g=["技术部","人事部","财务部","市场部","销售部"],L=a({keyword:"",department:"",status:""}),N=a({name:"",username:"",department:"",position:"",joinDate:"",status:"active"}),X=l(!1),B=l(!1),F=l([]),G=l(null),H=l(!1),J=async()=>{try{H.value=!0;const{data:e}=await h();F.value=e}catch(e){}finally{H.value=!1}},P=async()=>{var e;try{if(B.value&&(null==(e=G.value)?void 0:e.id)){await f({...N,id:G.value.id,status:G.value.status});const e=F.value.findIndex((e=>{var a;return e.id===(null==(a=G.value)?void 0:a.id)}));-1!==e&&(F.value[e]={...G.value,...N})}else{const{data:e}=await k({...N,status:"active"});F.value.push(e)}Q()}catch(a){}},Q=()=>{X.value=!1,B.value=!1,G.value=null,Object.assign(N,{name:"",username:"",department:"",position:"",joinDate:"",status:"active"})};return t((()=>{J()})),(e,a)=>(m(),n("div",j,[s("div",D,[a[9]||(a[9]=s("h2",null,"员工管理",-1)),s("button",{class:"add-button",onClick:a[0]||(a[0]=e=>X.value=!0)},"添加员工")]),s("div",C,[s("div",V,[u(s("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>L.keyword=e),placeholder:"搜索姓名/用户名",class:"search-input"},null,512),[[o,L.keyword]]),u(s("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>L.department=e),class:"search-select"},[a[10]||(a[10]=s("option",{value:""},"所有部门",-1)),(m(),n(d,null,r(g,(e=>s("option",{key:e,value:e},c(e),9,w))),64))],512),[[i,L.department]]),u(s("select",{"onUpdate:modelValue":a[3]||(a[3]=e=>L.status=e),class:"search-select"},a[11]||(a[11]=[s("option",{value:""},"所有状态",-1),s("option",{value:"active"},"在职",-1),s("option",{value:"resigned"},"离职",-1)]),512),[[i,L.status]])]),s("button",{class:"search-button",onClick:J},"搜索")]),s("div",U,[s("table",null,[a[12]||(a[12]=s("thead",null,[s("tr",null,[s("th",null,"用户名"),s("th",null,"姓名"),s("th",null,"部门"),s("th",null,"职位"),s("th",null,"入职日期"),s("th",null,"状态"),s("th",null,"操作")])],-1)),s("tbody",null,[(m(!0),n(d,null,r(F.value,(e=>{return m(),n("tr",{key:e.id},[s("td",null,c(e.username),1),s("td",null,c(e.name),1),s("td",null,c(e.department),1),s("td",null,c(e.position),1),s("td",null,c((a=e.joinDate,new Date(a).toLocaleDateString("zh-CN"))),1),s("td",null,[s("span",{class:b(["status",e.status])},c("active"===e.status?"在职":"离职"),3)]),s("td",null,[s("button",{class:"action-button edit",onClick:a=>(e=>{G.value=e,Object.assign(N,{name:e.name,username:e.username,department:e.department,position:e.position,joinDate:e.joinDate}),B.value=!0})(e)},"编辑",8,_),"active"===e.status?(m(),n("button",{key:0,class:"action-button delete",onClick:a=>(async e=>{if(e.id&&confirm("确定要删除该员工吗？"))try{await y(e.id),F.value=F.value.filter((a=>a.id!==e.id))}catch(a){}})(e)}," 删除 ",8,q)):v("",!0)])]);var a})),128))])])]),X.value||B.value?(m(),n("div",x,[s("div",I,[s("h3",null,c(B.value?"编辑员工":"添加员工"),1),s("form",{onSubmit:p(P,["prevent"])},[s("div",O,[a[13]||(a[13]=s("label",null,"用户名",-1)),u(s("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>N.username=e),required:"",disabled:B.value},null,8,z),[[o,N.username]])]),s("div",M,[a[14]||(a[14]=s("label",null,"姓名",-1)),u(s("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>N.name=e),required:""},null,512),[[o,N.name]])]),s("div",S,[a[15]||(a[15]=s("label",null,"部门",-1)),u(s("select",{"onUpdate:modelValue":a[6]||(a[6]=e=>N.department=e),required:""},[(m(),n(d,null,r(g,(e=>s("option",{key:e,value:e},c(e),9,A))),64))],512),[[i,N.department]])]),s("div",E,[a[16]||(a[16]=s("label",null,"职位",-1)),u(s("input",{"onUpdate:modelValue":a[7]||(a[7]=e=>N.position=e),required:""},null,512),[[o,N.position]])]),s("div",K,[a[17]||(a[17]=s("label",null,"入职日期",-1)),u(s("input",{type:"date","onUpdate:modelValue":a[8]||(a[8]=e=>N.joinDate=e),required:""},null,512),[[o,N.joinDate]])]),s("div",{class:"dialog-buttons"},[s("button",{type:"button",onClick:Q},"取消"),a[18]||(a[18]=s("button",{type:"submit"},"确定",-1))])],32)])])):v("",!0)]))}}),[["__scopeId","data-v-e81da4de"]]);export{L as default};
